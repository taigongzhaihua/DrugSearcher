<Window x:Class="DrugSearcher.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModels="clr-namespace:DrugSearcher.ViewModels"
        mc:Ignorable="d"
        Title="{Binding Title}"
        Height="600"
        Width="800"
        Style="{StaticResource BaseWindowStyle}"
        d:DataContext="{d:DesignInstance viewModels:MainWindowViewModel}">

    <Grid>
        <!-- 窗口顶部工具栏 -->
        <StackPanel HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Orientation="Horizontal"
                    Panel.ZIndex="10">

            <!-- 功能按钮组 -->
            <StackPanel Orientation="Horizontal" Margin="0,10,10,0">

                <!-- 主页按钮 -->
                <Button x:Name="HomeButton"
                        Content="{Binding HomeButtonText}"
                        Style="{DynamicResource TransparentThemeButtonStyle}"
                        Click="HomeButton_OnClick"
                        Margin="0,0,5,0"
                        ToolTip="主页"
                        WindowChrome.IsHitTestVisibleInChrome="True" />

                <!-- 导航按钮组 -->
                <StackPanel Orientation="Horizontal">
                    <!-- 后退按钮 -->
                    <Button x:Name="BackButton"
                            Content="&#xe617;"
                            Style="{DynamicResource TransparentThemeButtonStyle}"
                            Click="BackButton_OnClick"
                            Margin="0,0,5,0"
                            ToolTip="后退"
                            IsEnabled="{Binding CanGoBack, ElementName=MainFrame}"
                            WindowChrome.IsHitTestVisibleInChrome="True" />

                    <!-- 前进按钮 -->
                    <Button x:Name="ForwardButton"
                            Content="&#xe618;"
                            Style="{DynamicResource TransparentThemeButtonStyle}"
                            Click="ForwardButton_OnClick"
                            Margin="0,0,5,0"
                            ToolTip="前进"
                            IsEnabled="{Binding CanGoForward, ElementName=MainFrame}"
                            WindowChrome.IsHitTestVisibleInChrome="True" />
                </StackPanel>

                <!-- 设置按钮 -->
                <Button x:Name="SettingsButton"
                        Content="{Binding SettingsButtonText}"
                        Style="{DynamicResource TransparentThemeButtonStyle}"
                        Click="SettingsButton_OnClick"
                        Margin="0,0,5,0"
                        ToolTip="设置"
                        WindowChrome.IsHitTestVisibleInChrome="True" />

                <!-- 颜色主题按钮 -->
                <Button x:Name="ColorsButton"
                        Content="&#xe614;"
                        Style="{DynamicResource TransparentThemeButtonStyle}"
                        Click="ColorsButton_OnClick"
                        Margin="0,0,10,0"
                        ToolTip="{Binding ThemeTooltip}"
                        WindowChrome.IsHitTestVisibleInChrome="True" />
            </StackPanel>

            <!-- 窗口控制按钮组 -->
            <StackPanel Orientation="Horizontal" Margin="0,10,15,0">
                <!-- 最小化按钮 -->
                <Button x:Name="MinimizeButton"
                        Content="&#xe60e;"
                        Style="{DynamicResource TransparentThemeButtonStyle}"
                        Click="MinimizeButton_Click"
                        Margin="0,0,5,0"
                        ToolTip="最小化窗口"
                        WindowChrome.IsHitTestVisibleInChrome="True" />

                <!-- 最大化/还原按钮 -->
                <Button x:Name="MaximizeButton"
                        Content="&#xe60d;"
                        Style="{DynamicResource TransparentThemeButtonStyle}"
                        Click="MaximizeButton_OnClick"
                        Margin="0,0,5,0"
                        ToolTip="最大化窗口"
                        WindowChrome.IsHitTestVisibleInChrome="True" />

                <!-- 关闭按钮 -->
                <Button x:Name="CloseButton"
                        Content="&#xe60f;"
                        Style="{DynamicResource TransparentThemeButtonStyle}"
                        Click="CloseButton_Click"
                        Margin="0,0,0,0"
                        ToolTip="关闭窗口"
                        WindowChrome.IsHitTestVisibleInChrome="True" />
            </StackPanel>
        </StackPanel>

        <!-- 颜色主题选择弹出框 -->
        <Popup x:Name="ColorThemePopup"
               Placement="Bottom"
               PlacementTarget="{Binding ElementName=ColorsButton}"
               StaysOpen="False"
               AllowsTransparency="True"
               PopupAnimation="Slide">

            <Border Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Margin="5"
                    Effect="{StaticResource DropShadowEffect}">

                <Grid Margin="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- 弹出框标题 -->
                    <TextBlock Grid.Row="0" Grid.Column="0"
                               Text="选择主题颜色"
                               FontSize="14"
                               FontWeight="Medium"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               HorizontalAlignment="Left"
                               VerticalAlignment="Center"
                               Margin="0,0,0,0" />

                    <!-- 明暗模式切换按钮 -->
                    <Button Grid.Row="0" Grid.Column="1"
                            Content="{Binding ThemeButtonText}"
                            Style="{StaticResource TransparentThemeButtonStyle}"
                            Command="{Binding SwitchThemeCommand}"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            Margin="12,0,0,0"
                            ToolTip="{Binding ThemeTooltip}"
                            WindowChrome.IsHitTestVisibleInChrome="True" />

                    <!-- 颜色选择网格 -->
                    <UniformGrid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                 Columns="4" Rows="2"
                                 Margin="0,8,0,0">

                        <!-- 蓝色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="蓝色主题"
                                     Tag="Blue"
                                     IsChecked="{Binding ColorSelectionStates[Blue]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Blue"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#2196F3" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 粉色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="粉色主题"
                                     Tag="Pink"
                                     IsChecked="{Binding ColorSelectionStates[Pink]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Pink"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#E91E63" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 青色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="青色主题"
                                     Tag="Cyan"
                                     IsChecked="{Binding ColorSelectionStates[Cyan]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Cyan"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#00BCD4" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 绿色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="绿色主题"
                                     Tag="Green"
                                     IsChecked="{Binding ColorSelectionStates[Green]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Green"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#4CAF50" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 紫色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="紫色主题"
                                     Tag="Purple"
                                     IsChecked="{Binding ColorSelectionStates[Purple]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Purple"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#9C27B0" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 橙色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="橙色主题"
                                     Tag="Orange"
                                     IsChecked="{Binding ColorSelectionStates[Orange]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Orange"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#FF9800" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 红色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="红色主题"
                                     Tag="Red"
                                     IsChecked="{Binding ColorSelectionStates[Red]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Red"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#F44336" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>

                        <!-- 靛蓝色主题 -->
                        <RadioButton Style="{DynamicResource ColorPickerRadioButtonStyle}"
                                     GroupName="ThemeColors"
                                     ToolTip="靛蓝色主题"
                                     Tag="Indigo"
                                     IsChecked="{Binding ColorSelectionStates[Indigo]}"
                                     Command="{Binding SwitchThemeColorCommand}"
                                     CommandParameter="Indigo"
                                     Margin="2">
                            <RadioButton.Content>
                                <Ellipse Width="24" Height="24" 
                                         Fill="#3F51B5" 
                                         UseLayoutRounding="True"
                                         SnapsToDevicePixels="True" />
                            </RadioButton.Content>
                        </RadioButton>
                    </UniformGrid>
                </Grid>
            </Border>
        </Popup>

        <!-- 主要内容区域 -->
        <Grid Margin="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- 应用图标和标题栏 -->
            <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                        Orientation="Horizontal"
                        Margin="15,10,0,10">

                <!-- 应用图标 -->
                <TextBlock x:Name="ApplicationIcon"
                           Text="&#xe622;"
                           FontFamily="{DynamicResource IconFont}"
                           FontSize="18"
                           Foreground="{DynamicResource PrimaryBrush}"
                           VerticalAlignment="Center"
                           Margin="0,0,10,0" />

                <!-- 应用标题 -->
                <TextBlock Text="{Binding Title}"
                           FontSize="16"
                           FontWeight="Medium"
                           Foreground="{DynamicResource PrimaryTextBrush}"
                           VerticalAlignment="Center" />
            </StackPanel>

            <!-- 页面导航框架 -->
            <Frame x:Name="MainFrame"
                   Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                   Margin="5"
                   NavigationUIVisibility="Hidden"
                   Background="Transparent" />
        </Grid>
    </Grid>
</Window>